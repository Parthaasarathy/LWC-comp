public class ClaimApprovalProcess {
    private static final Decimal APPROVED_LIMIT = 10000;
    
    public void processClaims() {
        // Step 1: Retrieve all claims with a status of 'Submitted'
        List<Claim__c> claimsToProcess = [SELECT Id, Claim_Amount__c, Status__c, Claimant_Id__c, Claimant_Email__c 
                                          FROM Claim__c 
                                          WHERE Status__c = 'Submitted'];
        
        // Get the User Id of the claims manager named 'John Walker'
        User claimsManager = [SELECT Id FROM User WHERE Name = 'John Walker' LIMIT 1];
        
        // List to store claims to update
        List<Claim__c> claimsToUpdate = new List<Claim__c>();
        
        for (Claim__c claim : claimsToProcess) {
            if (claim.Claim_Amount__c <= APPROVED_LIMIT) {
                // Step 3: Update the status to 'Approved'
                claim.Status__c = 'Approved';
                claimsToUpdate.add(claim);
                
                // Send email notification
                sendApprovalEmail(claim);
            } else {
                // Step 4: Update the status to 'Requires Manual Review'
                claim.Status__c = 'Requires Manual Review';
                claim.OwnerId = claimsManager.Id;  // Assign to claims manager
                claimsToUpdate.add(claim);
            }
        }
        
        // Update the claims
        if (!claimsToUpdate.isEmpty()) {
            update claimsToUpdate;
        }
    }
    
    private void sendApprovalEmail(Claim__c claim) {
        // Construct the email message
        Messaging.SingleEmailMessage email = new Messaging.SingleEmailMessage();
        email.setToAddresses(new String[] {claim.Claimant_Email__c});
        email.setSubject('Your Claim has been Approved');
        email.setPlainTextBody('Dear Claimant, your claim with ID ' + claim.Id + ' has been approved.');
        
        // Send the email
        Messaging.sendEmail(new Messaging.SingleEmailMessage[] {email});
    }
}