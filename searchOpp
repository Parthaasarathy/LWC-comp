<template>
    <lightning-card title="Search Opportunities">
        <div class="slds-p-horizontal_small">
            <!-- Get Record by Stage -->
            <lightning-combobox label="Get Record by Stage"
                                value={stageValue}
                                placeholder="Select Stage"
                                options={stageOptions}
                                onchange={handleStageChange}>
            </lightning-combobox>

            <!-- Sort by Field -->
            <lightning-combobox label="Sort by Field"
                                value={sortFieldValue}
                                placeholder="Select Field"
                                options={sortFieldOptions}
                                onchange={handleSortFieldChange}>
            </lightning-combobox>

            <!-- Sort Order -->
            <lightning-combobox label="Sort Order"
                                value={sortOrderValue}
                                placeholder="Select Sort Order"
                                options={sortOrderOptions}
                                onchange={handleSortOrderChange}>
            </lightning-combobox>

            <!-- Search Button -->
            <lightning-button label="Search" onclick={handleSearch} class="slds-m-top_small"></lightning-button>
        </div>
    </lightning-card>

    <!-- Child Component to Display Results -->
    <c-opportunity-results></c-opportunity-results>
</template>



import { LightningElement, track } from 'lwc';

export default class SearchOpportunities extends LightningElement {
    @track stageValue = '';
    @track sortFieldValue = '';
    @track sortOrderValue = '';

    stageOptions = [
        { label: 'Prospecting', value: 'Prospecting' },
        { label: 'Qualification', value: 'Qualification' },
        { label: 'Needs Analysis', value: 'Needs Analysis' },
        { label: 'Proposal/Price Quote', value: 'Proposal/Price Quote' },
        { label: 'Negotiation/Review', value: 'Negotiation/Review' },
        { label: 'Closed Won', value: 'Closed Won' },
        { label: 'Closed Lost', value: 'Closed Lost' }
    ];

    sortFieldOptions = [
        { label: 'Amount', value: 'Amount' },
        { label: 'Close Date', value: 'CloseDate' },
        { label: 'Created Date', value: 'CreatedDate' },
        { label: 'Last Modified Date', value: 'LastModifiedDate' }
    ];

    sortOrderOptions = [
        { label: 'Ascending', value: 'ASC' },
        { label: 'Descending', value: 'DESC' }
    ];

    handleStageChange(event) {
        this.stageValue = event.target.value;
    }

    handleSortFieldChange(event) {
        this.sortFieldValue = event.target.value;
    }

    handleSortOrderChange(event) {
        this.sortOrderValue = event.target.value;
    }

    handleSearch() {
        const searchCriteria = {
            stage: this.stageValue,
            sortField: this.sortFieldValue,
            sortOrder: this.sortOrderValue
        };

        // Fire a custom event to send data to the child component
        const searchEvent = new CustomEvent('search', {
            detail: searchCriteria
        });
        this.template.querySelector('c-opportunity-results').handleSearchCriteria(searchCriteria);
    }
}